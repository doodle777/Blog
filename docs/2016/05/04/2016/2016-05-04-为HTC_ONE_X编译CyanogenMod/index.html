<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>为 HTC ONE X 编译 CyanogenMod | MAY THE FORCE BE WITH YOU</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="ROM,Recovery,CyanogenMod">
    <meta name="description" content="content{:toc}  本文翻译自CyanogenMod Wiki。 1.简介　　这个教程将帮助你从一个解锁了 bootloader 的 HTC ONE X （以下简称 HOX）开始，然后下载必要的工具和基于谷歌安卓系统的最新的 CyanogenMod 源代码。通过这些，你可以从源代码编译 CyanogenMod 和 CyanogenMod Recovery 镜像，然后将其安装到你的手机。">
<meta name="keywords" content="ROM,Recovery,CyanogenMod">
<meta property="og:type" content="article">
<meta property="og:title" content="为 HTC ONE X 编译 CyanogenMod">
<meta property="og:url" content="http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/index.html">
<meta property="og:site_name" content="MAY THE FORCE BE WITH YOU">
<meta property="og:description" content="content{:toc}  本文翻译自CyanogenMod Wiki。 1.简介　　这个教程将帮助你从一个解锁了 bootloader 的 HTC ONE X （以下简称 HOX）开始，然后下载必要的工具和基于谷歌安卓系统的最新的 CyanogenMod 源代码。通过这些，你可以从源代码编译 CyanogenMod 和 CyanogenMod Recovery 镜像，然后将其安装到你的手机。">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-12-07T12:48:31.171Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="为 HTC ONE X 编译 CyanogenMod">
<meta name="twitter:description" content="content{:toc}  本文翻译自CyanogenMod Wiki。 1.简介　　这个教程将帮助你从一个解锁了 bootloader 的 HTC ONE X （以下简称 HOX）开始，然后下载必要的工具和基于谷歌安卓系统的最新的 CyanogenMod 源代码。通过这些，你可以从源代码编译 CyanogenMod 和 CyanogenMod Recovery 镜像，然后将其安装到你的手机。">
    
        <link rel="alternate" type="application/atom+xml" title="MAY THE FORCE BE WITH YOU" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon_64.png">
    <link rel="stylesheet" href="/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">Duan Xu</h5>
          <a href="mailto:duanxu@outlook.com" title="duanxu@outlook.com" class="mail">duanxu@outlook.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/">
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives">
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags">
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/categories">
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/doodle777" target="_blank">
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://weibo.com/u/2886472974" target="_blank">
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">为 HTC ONE X 编译 CyanogenMod</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">为 HTC ONE X 编译 CyanogenMod</h1>
        <h5 class="subtitle">
            
                <time datetime="2016-05-04T04:06:00.000Z" itemprop="datePublished" class="page-time">
  2016-05-04
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Other/">Other</a></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container-post body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#1-简介"><span class="post-toc-number">1.</span> <span class="post-toc-text">1.简介</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-1-你将需要的"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">1.1 你将需要的</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#2-编译-CyanogenMod-和-CyanogenMod-Recovery"><span class="post-toc-number">2.</span> <span class="post-toc-text">2.编译 CyanogenMod 和 CyanogenMod Recovery</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-1-准备编译环境"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">2.1 准备编译环境</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-1-1-安装-SDK"><span class="post-toc-number">2.1.1.</span> <span class="post-toc-text">2.1.1 安装 SDK</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#2-1-2-安装依赖包"><span class="post-toc-number">2.1.2.</span> <span class="post-toc-text">2.1.2 安装依赖包</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-2-建立目录"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2.2 建立目录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-3-安装-repo-命令"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">2.3 安装 repo 命令</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-4-将-bin-目录加入到执行目录"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">2.4 将 ~/bin 目录加入到执行目录</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-5-初始化-CyanogenMod-repository"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">2.5 初始化 CyanogenMod repository</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-6-下载源代码"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">2.6 下载源代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-7-获取预编译的APP（适用于CM11和更低版本）"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">2.7 获取预编译的APP（适用于CM11和更低版本）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-8-准备设备专用代码"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">2.8 准备设备专用代码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-9-提取所有的blobs文件"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">2.9 提取所有的blobs文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-10-开启缓存来优化编译速度"><span class="post-toc-number">2.10.</span> <span class="post-toc-text">2.10 开启缓存来优化编译速度</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-11-开始编译"><span class="post-toc-number">2.11.</span> <span class="post-toc-text">2.11 开始编译</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-12-如果编译中断…"><span class="post-toc-number">2.12.</span> <span class="post-toc-text">2.12 如果编译中断…</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#3-安装构建"><span class="post-toc-number">3.</span> <span class="post-toc-text">3.安装构建</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-使用fastboot安装Recovery"><span class="post-toc-number">4.</span> <span class="post-toc-text">4.使用fastboot安装Recovery</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-1-安装-CyanogenMod"><span class="post-toc-number">4.1.</span> <span class="post-toc-text">4.1 安装 CyanogenMod</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-2-成功！接下来…"><span class="post-toc-number">4.2.</span> <span class="post-toc-text">4.2 成功！接下来…</span></a></li></ol></li></ol>
        </nav>
    </aside>


<article id="post-2016/2016-05-04-为HTC_ONE_X编译CyanogenMod" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">为 HTC ONE X 编译 CyanogenMod</h1>
        <div class="post-meta">
            <time class="post-time" title="2016-05-04 12:06:00" datetime="2016-05-04T04:06:00.000Z" itemprop="datePublished">2016-05-04</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/categories/Other/">Other</a></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style="display:none">
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <ul>
<li>content<br>{:toc}</li>
</ul>
<p><strong>本文翻译自<a href="http://wiki.cyanogenmod.org/w/Build_for_endeavoru" target="_blank" rel="noopener">CyanogenMod Wiki</a>。</strong></p>
<h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h3><p>　　这个教程将帮助你从一个解锁了 bootloader 的 HTC ONE X （以下简称 HOX）开始，然后下载必要的工具和基于谷歌安卓系统的最新的 CyanogenMod 源代码。通过这些，你可以从源代码编译 CyanogenMod 和 CyanogenMod Recovery 镜像，然后将其安装到你的手机。</p>
<p>　　很难讲清楚顺利完成这个教程需要多少经验。这个教程显然不是为了纯小白准备的，但是你也不需要一个软件工程的博士学位。一些读者可以无障碍的顺利完成此教程。另一些人可能需要在基本操作上进行一些探索。因为每个人的经历、背景和经验都是不同的。每进行一步都弄清楚你是否理解并正确执行了是很重要的。</p>
<p>　　记住，你可能遇到很多困难，但是克服这些困难是值得的！在自己家中就能够为你的手机安装一个全新的操作系统，这是很令人愉快的。一旦你成为一个安卓大神，你就不需要等待每日编译版（nightly）。因为你具备了从源代码编译安装完整操作系统的能力。为了成为一个大神，你可能需要增加一个功能、修复一个BUG、添加语言支持、学习编译一个新的 APP或者将源码编译到一个新的设备，这完全取决于你自己喜好。</p>
<h4 id="1-1-你将需要的"><a href="#1-1-你将需要的" class="headerlink" title="1.1 你将需要的"></a>1.1 你将需要的</h4><ul>
<li>一台 HTC ONE X  </li>
<li>一台较新的电脑（Linux，OS X，或者 Windows），拥有可观的 RAM 和 100GB 以上的可用空间（如果你开启了 ccache 或者为多台设备构造，你可能需要更多）。RAM 越小编译时间越久（推荐 8GB 或更多）。使用 SSD 会显著提升编译的速度。  </li>
<li>一根和 HOX 兼容的 USB 数据线。</li>
<li>熟悉基本的安卓系统和终端的操作。如果你安装过自定义的 ROM，或者你熟悉 recovery，这会是很有帮助的。了解基本的终端命令也是很有用的，比如 cd(change directory)。</li>
</ul>
<p>　　学习使用 Linux 很有挑战，如果你不熟悉 Linux 的使用，那么就下载一个虚拟机软件，比如 VirtualBox，然后在其中安装 Ubuntu 来学习 Linux。任何最近的64位版本都能得到很好的支持，但是我们推荐使用最新的版本。</p>
<blockquote>
<p>注意：<br>你需要使用64位的系统，一个32位的环境只支持编译 CyanogenMod 6 或者更早的系统。对于 CyanogenMod 10.1 如果你遇到了64位主机问题，你可以在你的环境中设置 “BUILD_HOST_32bit=1”。这通常是不需要的，尤其是在 CyanogenMod 10.2 或更新的版本中。  </p>
</blockquote>
<p>　　使用一个虚拟机可以在你的现有系统内再运行一个系统。如果你对任何版本的 Linux 都觉得厌烦，你总是可以卸载和删除所有的东西。设置一个 Ubuntu 虚拟机的教程满世界都找得到，对此不在赘述。</p>
<p>　　好，我们现在开始把！</p>
<hr>
<h3 id="2-编译-CyanogenMod-和-CyanogenMod-Recovery"><a href="#2-编译-CyanogenMod-和-CyanogenMod-Recovery" class="headerlink" title="2.编译 CyanogenMod 和 CyanogenMod Recovery"></a>2.编译 CyanogenMod 和 CyanogenMod Recovery</h3><h4 id="2-1-准备编译环境"><a href="#2-1-准备编译环境" class="headerlink" title="2.1 准备编译环境"></a>2.1 准备编译环境</h4><blockquote>
<p>注意：<br>你仅仅在第一次编译的时候需要做这些，如果你已经准备好了环境，然后下载了 CyanogenMod 源代码，请移步“<a href="#device-specific">准备设备专用代码</a>”。  </p>
</blockquote>
<h5 id="2-1-1-安装-SDK"><a href="#2-1-1-安装-SDK" class="headerlink" title="2.1.1 安装 SDK"></a>2.1.1 安装 SDK</h5><p>　　如果你之前没有安装 <a href="http://wiki.cyanogenmod.org/w/Doc:_adb_intro" target="_blank" rel="noopener">adb</a> 和 <a href="http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro" target="_blank" rel="noopener">fastboot</a>，请安装 Android SDK。SDK(Software Developer Kit)，软件开发包。其中包括一些有用的工具，通过这些工具，你可以刷新软件、查看系统时间、截图等等。所有的这些都通过电脑来完成。</p>
<blockquote>
<p>注意：<br>SDK包含很多不同的工具，adb 和 fastboot 是最有用的工具之一，位于 /platform-tools 目录下。  </p>
</blockquote>
<h5 id="2-1-2-安装依赖包"><a href="#2-1-2-安装依赖包" class="headerlink" title="2.1.2 安装依赖包"></a>2.1.2 安装依赖包</h5><p>　　要想编译 CyanogenMod，需要几个依赖包，你可以通过包管理器安装。</p>
<blockquote>
<p>注意：<br>Linux 的包管理器用于安装或者卸载软件（通常通过网络安装），对于 Ubuntu，你可以使用 Ubuntu 软件中心。或者，你可以使用 apt-get install 命令直接在终端中安装软件。  </p>
</blockquote>
<p>　　对于32位和64位系统，都需要：</p>
<blockquote>
<p>bison build-essential curl flex git gnupg gperf libesd0-dev liblz4-tool libncurses5-dev libsdl1.2-dev libwxgtk2.8-dev libxml2 libxml2-utils lzop maven openjdk-7-jdk openjdk-7-jre pngcrush schedtool squashfs-tools xsltproc zip zlib1g-dev</p>
</blockquote>
<p>　　除了以上的依赖包，64位系统还需要：</p>
<blockquote>
<p>g++-multilib gcc-multilib lib32ncurses5-dev lib32readline-gplv2-dev lib32z1-dev</p>
</blockquote>
<p>　　查询此网页可以看到详细的列表：<a href="http://source.android.com/source/initializing.html" target="_blank" rel="noopener">依赖列表</a></p>
<h4 id="2-2-建立目录"><a href="#2-2-建立目录" class="headerlink" title="2.2 建立目录"></a>2.2 建立目录</h4><p>　　你需要在编译环境中新建一个目录：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p ~/bin</span><br><span class="line">$ mkdir -p ~/android/system</span><br></pre></td></tr></table></figure>
<h4 id="2-3-安装-repo-命令"><a href="#2-3-安装-repo-命令" class="headerlink" title="2.3 安装 repo 命令"></a>2.3 安装 repo 命令</h4><p>　　输入下列命令下载“repo”二进制文件，并将其设置为可执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo</span><br><span class="line">$ chmod a+x ~/bin/repo</span><br></pre></td></tr></table></figure>
<h4 id="2-4-将-bin-目录加入到执行目录"><a href="#2-4-将-bin-目录加入到执行目录" class="headerlink" title="2.4 将 ~/bin 目录加入到执行目录"></a>2.4 将 ~/bin 目录加入到执行目录</h4><p>　　在较新版本的 Ubuntu 中，~/bin 目录应该已经位于 <a href="http://wiki.cyanogenmod.org/w/Doc:_paths" target="_blank" rel="noopener">PATH</a> 内，你可以使用文本编辑器打开 ~/.profile 文件来检查以下代码是否存在：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set PATH so it includes user's private bin if it exists</span></span><br><span class="line"><span class="keyword">if</span> [ -d <span class="string">"<span class="variable">$HOME</span>/bin"</span> ] ; <span class="keyword">then</span></span><br><span class="line">    PATH=<span class="string">"<span class="variable">$HOME</span>/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<h4 id="2-5-初始化-CyanogenMod-repository"><a href="#2-5-初始化-CyanogenMod-repository" class="headerlink" title="2.5 初始化 CyanogenMod repository"></a>2.5 初始化 CyanogenMod repository</h4><p>　　输入下列代码来初始化 CyanogenMod repository。确保此处的 cm 分支是你想编译的，同时支持你的设备。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/android/system/</span><br><span class="line">$ repo init -u https://github.com/CyanogenMod/android.git -b cm-12.1</span><br></pre></td></tr></table></figure>
<h4 id="2-6-下载源代码"><a href="#2-6-下载源代码" class="headerlink" title="2.6 下载源代码"></a>2.6 下载源代码</h4><p>　　开始下载源代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ repo sync</span><br></pre></td></tr></table></figure>
<p>　　CM 清单包含了一个默认的 repo 配置，我们强烈推荐你使用默认的配置（比如对 sync 不添加任何的参数）。举例来说，我们的默认配置是 “-j 4” 和 “-c”。“-j 4”意味着将会建立4个虚拟链接。如果你遇到了链接错误，你可以降低此链接数“-j 3”或者“-j 2”。“-c”意味着请求 repo 仅仅更新当前分支的最新状态，而不是整个 CM 历史版本。</p>
<p>　　下载将花费您很长时间，请耐心等待。</p>
<blockquote>
<p>注意：<br>repo sync 命令用来从 CyanogenMod 和 Google 更新最新的源代码。记住，你可以每隔几天更新一次以便保持你的源代码为最新状态。  </p>
</blockquote>
<h4 id="2-7-获取预编译的APP（适用于CM11和更低版本）"><a href="#2-7-获取预编译的APP（适用于CM11和更低版本）" class="headerlink" title="2.7 获取预编译的APP（适用于CM11和更低版本）"></a>2.7 获取预编译的APP（适用于CM11和更低版本）</h4><p>　　输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/android/system/vendor/cm</span><br></pre></td></tr></table></figure>
<p>　　然后：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./get-prebuilts</span><br></pre></td></tr></table></figure>
<p>　　你将不会看到任何确认信息，这将导致一些预编译的应用被加载和安装到源代码内。一旦完成之后，将不需要做第二次。</p>
<p><span id="device-specific"></span></p>
<h4 id="2-8-准备设备专用代码"><a href="#2-8-准备设备专用代码" class="headerlink" title="2.8 准备设备专用代码"></a>2.8 准备设备专用代码</h4><p>　　完成下载源代码之后，确保你在源代码根目录下（cd ~/android/system），然后键入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> build/envsetup.sh</span><br><span class="line">$ breakfast endeavoru</span><br></pre></td></tr></table></figure>
<p>　　这会下载设备专用代码和设备内核代码。</p>
<p>　　一个可选的使用 breakfast 命令的方式是编译<a href="http://wiki.cyanogenmod.org/w/Doc:_Using_manifests#The_local_manifest" target="_blank" rel="noopener">本地列表</a>。为了完成这个，需要你下载<a href="http://github.com/CyanogenMod" target="_blank" rel="noopener">CM Github</a>上列出的所有定义在 cm.dependencies 内的 repo，下载到你的本地列表内。</p>
<blockquote>
<p>注意：  </p>
<ol>
<li>breakfast 期间的错误  <ul>
<li>不同的维护者设计他们设备的继承规则是不同的，有些需要首先完成供应商目录后才可以进行 breakfast。如果你在供应商 makefiles 时得到一个错误，那么就跳转到下一节“提取所有的 blobs 文件”。首先确保 breakfast 被成功推送到了设备树中，并且提取 blobs 脚本应处于可用状态。在完成这个部分之后，你可以重新运行 breakfast endeavoru。   </li>
</ul>
</li>
<li>如果你想了解更多关于“source build/envsetup.sh”做了什么，或者了解 breakfast、brunch、lunch命令，单机此链接：<a href="http://wiki.cyanogenmod.org/w/Envsetup_help" target="_blank" rel="noopener">Envsetup help</a>。  </li>
<li>为了方便每次返回源码根目录都需要键入“cd ~/android/system”，你可以使用 croot。为了使用此命令，你必须首先从“~/android/system”运行“source build/envsetup.sh”。  </li>
</ol>
</blockquote>
<h4 id="2-9-提取所有的blobs文件"><a href="#2-9-提取所有的blobs文件" class="headerlink" title="2.9 提取所有的blobs文件"></a>2.9 提取所有的blobs文件</h4><p>　　现在确保你的 HOX 已经通过 USB 连接线连接到你的电脑，并且你位于“~/android/system/device/htc/endeavoru”目录，如果需要的话你可以通过“cd ~/android/system/device/htc/endeavoru”来返回。然后运行以下脚本：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ./extract-files.sh</span><br></pre></td></tr></table></figure>
<p>　　你将会在“~/android/system/vendor/htc”目录下看到从你设备中提取出来的“blobs”文件。如果你看到类似adb不能提取出文件的错误，可能是因为adb的路径没有添加到环境变量的原因，如果是这样的话，你可以查看这个关于处理”command not found”的错误信息的链接：<a href="http://wiki.cyanogenmod.org/w/Adb" target="_blank" rel="noopener">adb</a>。</p>
<blockquote>
<p>注意：<br>1、为了让 extract-files.sh 脚本正常工作，你的设备应当已经在运行 CyanogenMod 的某个编译版本。<br>2、使用 extract-files.sh 脚本将所有的文件释放到“~/android/system/vendor/htc”目录是很重要的。同时会生成 Makefiles 文件来确保 blobs 文件被拷贝到设备内。如果没有这些 blobs 文件，编译 CyanogenMod 时不会出现任何错误，但是你可能丢失一些重要的功能，比如设备可能因为图形库的丢失而不显示任何东西。  </p>
</blockquote>
<h4 id="2-10-开启缓存来优化编译速度"><a href="#2-10-开启缓存来优化编译速度" class="headerlink" title="2.10 开启缓存来优化编译速度"></a>2.10 开启缓存来优化编译速度</h4><p>　　你可以加快编译速度，添加“export USE_CCACHE=1”到你的<a href="http://superuser.com/questions/49289/what-is-the-bashrc-file" target="_blank" rel="noopener">“~/.bashrc”</a>文件。然后指定 ccache 可用的磁盘空间：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prebuilts/misc/linux-x86/ccache/ccache -M 50G</span><br></pre></td></tr></table></figure>
<p>　　这里的 50G 指的是缓存的空间，这只需要做一次，然后此设置将被记住。从 25GB 到 100GB 范围的缓存将显著影响编译的速度（比如一小时的编译过程可能被缩短到20分钟）。如果你只是为一个设备构造，那么25GB-50GB的空间就足够了，如果你为多个设备构造，而且不同的设备间不共享相同的内核源码，那么你需要分配75GB-100GB的空间。这些缓存空间将被永久的在你得驱动器上被占用。<a href="http://source.android.com/source/initializing.html#setting-up-ccache" target="_blank" rel="noopener">了解更多关于 ccahche 的信息</a>。</p>
<blockquote>
<p>注意：<br>如果你是一名非常活跃的开发者，不仅仅工作在Android项目上，你可能倾向于将你的 Android ccahce 独立出来，因为它占用空间巨大，而且可能会降低其他项目的效率。那么就从 CyanogenMod 12.1 开始，你可以通过环境变量指定缓存的地址和大小：<br>export ANDROID_CCACHE_DIR=”$HOME/android/.ccache”<br>export ANDROID_CCACHE_SIZE=”50G”  </p>
</blockquote>
<h4 id="2-11-开始编译"><a href="#2-11-开始编译" class="headerlink" title="2.11 开始编译"></a>2.11 开始编译</h4><p>　　现在到了编译的时候了，输入：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ croot</span><br><span class="line">$ brunch endeavoru</span><br></pre></td></tr></table></figure>
<p>　　然后编译将开始自动执行。</p>
<blockquote>
<p>注意：<br>1、如果编译没有开始，尝试 lunch 然后从菜单中选择你的设备。如果这仍然不工作，尝试 breakfast 然后从菜单选择，然后 make endeavoru 将开始工作。<br>2、再次注意，如果在使用 croot、brunch、lunch 的时候提示“command not found”的错误，请确认你已经在终端中的“~/android/system”目录下执行了下面这个脚本：“.build/envsetup.sh”。  </p>
</blockquote>
<h4 id="2-12-如果编译中断…"><a href="#2-12-如果编译中断…" class="headerlink" title="2.12 如果编译中断…"></a>2.12 如果编译中断…</h4><p>　　如果你遇到类似内存不足的错误：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR: signapk.jar failed: <span class="built_in">return</span> code 1make: *** \[out/target/product/endeavoru/cm_endeavoru-ota-eng.root.zip\] Error 1</span><br></pre></td></tr></table></figure>
<p>　　你可能需要做如下改动：打开“~/android/system/build/tools/releasetools/common.py”文件，查找“-Xmx2048m”（可能出现在“OPTIONS.java_args”下面，或者出现在“signapk.jar”附近）。然后将其更改为：“-Xmx1024m”或者“-Xmx512m”。然后重新编译。</p>
<p>　　如果你会突然看到什么无缘无故的被“killed”的消息，那么你的虚拟机可能内存溢出或者空间不足，请分配更多的资源，然后重试。</p>
<hr>
<h3 id="3-安装构建"><a href="#3-安装构建" class="headerlink" title="3.安装构建"></a>3.安装构建</h3><p>　　假设编译顺利完成，在同一个终端键入“$ cd $OUT”。在这你会看到生成的所有的文件，在“/system”目录下的我们称为system，在root目录下的将会成为你的ramdisk，在kernel目录下将会成为你的kernel…. 这些只是后台信息，下面的两个文件是我们最需要关注的：(1)recovery.img,它包含了 CyanogenMod 的 Recovery, (2)cm-[something].zip，它包含了 CyanogenMod 安装包。</p>
<hr>
<h3 id="4-使用fastboot安装Recovery"><a href="#4-使用fastboot安装Recovery" class="headerlink" title="4.使用fastboot安装Recovery"></a>4.使用fastboot安装Recovery</h3><p>　　单击此链接获得更多关于<a href="http://wiki.cyanogenmod.org/w/All_About_Recovery_Images" target="_blank" rel="noopener">自定义Recovery</a>的帮助。</p>
<ol>
<li>确保你的电脑安装有 fastboot 和 adb。  </li>
<li>通过 USB 连接你的 HOX 到电脑。  </li>
<li>确保可执行的 fastboot 程序位于 PATH 内，并且 Recovery 镜像和 fastboot 位于同一目录。  </li>
<li>打开终端，将手机重启至 fastboot 模式：“adb reboot bootloader”。或者通过手机特殊按键组合重启至此模式。  </li>
<li>一旦你的设备重启到 fastboot 模式，确认你的PC是否可以识别设备：“fastboot devices”。  <ul>
<li>如果你没有看到设备号，只看到“<waiting for="" device="">”，说明 fastboot 没有正确安装配置，<a href="http://wiki.cyanogenmod.org/w/Doc:_fastboot_intro" target="_blank" rel="noopener">点此查看更多帮助</a>。  </waiting></li>
<li>如果你看到“no permissions fastboot”，确保 <a href="http://wiki.cyanogenmod.org/w/UDEV" target="_blank" rel="noopener">UDEV</a> 规则被正确的配置了。  </li>
</ul>
</li>
<li>将 Recovery 安装到设备：“fastboot flash recovery your_recovery_image.img”。其中文字部分是 Recovery 镜像的名字。  </li>
<li>一旦安装完成，将设备重启到 Recovery 来确认安装是否成功。  <ul>
<li>有些 ROM 在安装时会覆盖 Recovery，所以请注意你的设备 ROM 是否存在这个问题。  </li>
</ul>
</li>
</ol>
<h4 id="4-1-安装-CyanogenMod"><a href="#4-1-安装-CyanogenMod" class="headerlink" title="4.1 安装 CyanogenMod"></a>4.1 安装 CyanogenMod</h4><p>　　返回“$OUT”目录，你应该看到某个文件名类似于：“cm-13.0-20160504-UNOFFICIAL-endeavoru.zip”。现在你可以像正常安装 ROM 那样在 Recovery 中安装。在此之前，请确保已经备份了重要的文件，同时备份当前系统，以防止在安装过程中出现错误。由于 CyanogenMod 没有备份功能，所以你可以选择其他 Recovery 来完成此工作，或者使用类似于 Titanium 之类的工具（需要 root 权限）。</p>
<h4 id="4-2-成功！接下来…"><a href="#4-2-成功！接下来…" class="headerlink" title="4.2 成功！接下来…"></a>4.2 成功！接下来…</h4><p>　　你成功了，欢迎加入自编译的精英俱乐部，你已经从头到尾编译了你的系统…希望你能在移植的过程中学到东西，并尝到一些乐趣。 现在你已经为你的设备成功编译 CyanogenMod，这个链接是一些关于下一步该做什么的建议：<a href="http://wiki.cyanogenmod.org/w/After_You_Build" target="_blank" rel="noopener">一些关于下一步该做什么的建议</a>。 此外，请在开发者主题的开发者中心上查看关于这个wiki各种详细的信息：<a href="http://wiki.cyanogenmod.org/w/Doc:_debugging_with_logcat" target="_blank" rel="noopener">收集logs信息</a>，知道<a href="http://wiki.cyanogenmod.org/w/Doc:_the_cm_source" target="_blank" rel="noopener">源代码目录里有些什么</a>，<a href="http://wiki.cyanogenmod.org/w/Doc:_using_gerrit" target="_blank" rel="noopener">提交你的贡献</a>，<a href="http://wiki.cyanogenmod.org/w/Doc:_porting_intro" target="_blank" rel="noopener">移植CygogenMod到新设备</a>和其它更多的内容。再次祝贺你！</p>

        </div>

        <!-- <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2018-12-07T12:48:31.171Z" itemprop="dateUpdated">2018-12-07 20:48:31</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/" target="_blank" rel="external">http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/</a>
        
    </div>
    
    <footer>
        <a href="http://blog.duanxu.tech">
            <img src="/img/avatar.jpg" alt="Duan Xu">
            Duan Xu
        </a>
    </footer>
</blockquote>
 -->
        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CyanogenMod/">CyanogenMod</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ROM/">ROM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Recovery/">Recovery</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&title=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&pic=http://blog.duanxu.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&title=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&via=http://blog.duanxu.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2016/05/15/2016/2016-05-15-LeetCode-316-RemoveDuplicateLetters/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">LeetCode 316. Remove Duplicate Letters(HARD)</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2016/05/03/2016/2016-05-03-LaTeX-CSharp-HTTP/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">C#开发基于Http的LaTeX数学公式转换器</h4>
      </a>
    </div>
  
</nav>



    

















</article>



</div>

        <footer class="footer">
    <div class="bottom">
        <p><span>Duan Xu &copy; 2015 - 2018</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&title=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&pic=http://blog.duanxu.tech/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&title=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《为 HTC ONE X 编译 CyanogenMod》 — MAY THE FORCE BE WITH YOU&url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/&via=http://blog.duanxu.tech" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://blog.duanxu.tech/2016/05/04/2016/2016-05-04-为HTC_ONE_X编译CyanogenMod/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACqklEQVR42u3aW47CMAwFUPa/6c4CePTarquOdPKFoJScVEqM7dcrHsfPkXy3+un7+8lvNQceHh7ewtQT2BGP9+vzeZaXGw8PD2+Nl9wu2XW/ffp7u/899ep88PDw8J7GS7b4/J45Hg8PD+//8noT/X0Y5GE0Hh4e3nN4SeJgnpadJCbWcy14eHh4/YpVc4O+8/VKfQ8PDw9vXFXPi2GTQloSah+tgYeHh7fByzfcvHUgn1C1uao6Tzw8PLwNXq+o30vdTgL35Nj48A4eHh7eAi+/aBJY9yZXbT44WVw8PDy8i3h5uasXUs+nmz+fr/8V8PDw8C7lTXIYOXV+auVLWehlwMPDwxvzkmapSaq3l7aohvUnpx8eHh7eRbycUS1f5YF4NQVcvg8eHh7eRbw8AZHcdJ5KyBO+hZ4yPDw8vGVetVEgZyQhdXJ4FFoW8PDw8BZ41fJVnq6dh+nJEhSSHXh4eHgX8fIGqWpg3Stl9RIcJ08MDw8P71Jeb+vP8ZPi2SQ2xsPDw9vj5Vt8NbE7x1yAxMPDw1vg5SFsr1hVbbpK0rX5gYSHh4e3wctvNE8KTEpo+UHy4bnh4eHh3chLtuNJOJ6neqtBNh4eHt4eb7TtxumGarjca8kqP0M8PDy8Bd4Rj/zn56M6Kzw8PLw9Xi/I7l1TXYgkPXESUuPh4eEt85Jb5xOqNgHMFxcPDw/vHl6vWaoQ2i60XpVz1Xh4eHhj3mSiveRFc3MvFtK+Nl3h4eHhjXnz5Gm1mWCSnqiG8nh4eHh7vHwSyes8lZDX9/OFwMPDw7uTl6di81tPGJPGAjw8PLyn8arfSgLu/PrycuDh4eE9gJeHufOEQi9NjIeHh3cP76pkaz6t/DjJF3GUa8HDw8OLeb0/+b2fyQPo3tI0Bx4eHl46kz8QMyvwgYpVpwAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="/js/main.min.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.7.2" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '失去灵魂(╯‵□′)╯︵┻━┻';
            clearTimeout(titleTime);
        } else {
            document.title = 'Blog | Duan Xu';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
